import camion.*
import cosas.*

describe "Prueba de objetos"{
    
    test "Un knight rider pesa 500kg y tiene peligrosidad 10" {
        assert.equals(500, knightRider.peso())
        assert.equals(10, knightRider.nivelPeligrosidad())
    }
    test "Un paquete con 100kg de arena pesa 100kg y tiene peligrosidad 1"{
        const ag = new ArenaAGranel(cantidad = 100)
        assert.equals(100, ag.peso())
        assert.equals(1, ag.nivelPeligrosidad())
    }
    test "Un bumblebee que es auto pesa 800 y tiene peligrosidad 15" {
        assert.equals(800, bumblebee.peso())
        assert.equals(15, bumblebee.nivelPeligrosidad())
    }
    test "Un bumblebee que es robot pesa 800 y tiene peligrosidad 30" {
        assert.equals(800, bumblebee.peso())
        bumblebee.cambiarModo()
        assert.equals(30, bumblebee.nivelPeligrosidad())
    }
    test "Un paquete de 100 ladrillos pesa 200kg y tiene peligrosidad 2" {
        const pl = new PaqueteDeLadrillos(cantidad = 100)
        assert.equals(200, pl.peso())
        assert.equals(2, pl.nivelPeligrosidad())
    }
    test "Una bateria antiaerea con misiles pesa 300 y tiene peligrosidad 100" {
        const ba = new BateriaAntiaerea(tieneMisiles = true)
        assert.equals(300, ba.peso())
        assert.equals(100, ba.nivelPeligrosidad())
    }
    test "Una bateria antiaerea sin misiles pesa 200 y tiene peligrosidad 0" {
        const ba = new BateriaAntiaerea(tieneMisiles = false)
        assert.equals(200, ba.peso())
        assert.equals(0, ba.nivelPeligrosidad())
    }
    test "Un paquete de 100kg de residuos radiactivos pesa 100kg y tiene peligrosidad 200" {
        const rr = new ResiduosRadiactivos(cantidad = 100)
        assert.equals(100, rr.peso())
        assert.equals(200, rr.nivelPeligrosidad())
    }
}
describe "Carga en camion"{
   
    test "Si no cargo nada el camion esta vacio" {
        assert.equals(#{}, camion.todaLaCarga())
        assert.equals(true, camion.estaVacio())
    }
    test "Cargar varias cosas"{
        camion.cargar(knightRider)
        assert.equals(#{knightRider}, camion.todaLaCarga())//Solo tiene al knightRider
        camion.cargar(bumblebee)
        assert.equals(#{knightRider, bumblebee}, camion.todaLaCarga())//Tiene al knightRider y bumblebee
        camion.descargar(bumblebee)
        assert.equals(#{knightRider}, camion.todaLaCarga())//Solo tiene al knightRider de nuevo
        camion.cargar(knightRider)
        camion.descargar(bumblebee)
    }
    test "Un bumblebee y 50kg de arena tienen peso par"{
        const arena50kg = new ArenaAGranel(cantidad = 50)
        camion.cargar(bumblebee)
        camion.cargar(arena50kg)
        assert.equals(true, camion.pesoTotalPar())
    }
    test "55 kg de arena NO tiene peso par"{
        const arena55kg = new ArenaAGranel(cantidad =55)
        camion.cargar(arena55kg)
        assert.equals(false, camion.pesoTotalPar())
    }
    test "Hay carga con peso X"{
        camion.cargar(bumblebee)
        assert.equals(true, camion.hayCargaConPeso(800))
    }
    test "Hay carga con peso X (varios elementos)"{
        const arena50kg = new ArenaAGranel(cantidad = 50)
        camion.cargar(bumblebee)
        camion.cargar(arena50kg)
        assert.equals(true, camion.hayCargaConPeso(50))
        assert.equals(true, camion.hayCargaConPeso(800))
        assert.equals(false, camion.hayCargaConPeso(500))
    }
}
describe "Peso en el camion" {
    test "Con un paquete de 300 ladrillos y un bumblebee el camion no esta lleno"{
        const pl = new PaqueteDeLadrillos(cantidad = 300)
        camion.cargar(pl)
        camion.cargar(bumblebee)
        assert.equals(2400, camion.pesoTotal())
        assert.equals(false, camion.estaLleno())
    }
    test "Con un paquete de 400 ladrillos y un bumblebee el camion esta lleno"{
        const pl = new PaqueteDeLadrillos(cantidad = 400)
        camion.cargar(pl)
        camion.cargar(bumblebee)
        assert.equals(2600, camion.pesoTotal())
        assert.equals(true, camion.estaLleno())
    }
}
describe "Peligrosidad en el camion"{ 
    test "Buscar objeto peligroso entre un bumblebee, una bateriaerea y residuos radiactivos"{
        const bateria = new BateriaAntiaerea(tieneMisiles = false)
        const residuosRadiactivos = new ResiduosRadiactivos(cantidad = 100)
        camion.cargar(bumblebee)
        camion.cargar(bateria)
        camion.cargar(residuosRadiactivos)
        assert.equals(bateria, camion.cosaConPeligrosidad(0))
        assert.equals(bumblebee, camion.cosaConPeligrosidad(15))
        assert.equals(residuosRadiactivos, camion.cosaConPeligrosidad(200))
        assert.throwsException({camion.cosaConPeligrosidad(30)})//No hay ninguno con peligrosidad 30
        bumblebee.cambiarModo()
        assert.equals(bumblebee, camion.cosaConPeligrosidad(30))
    }
    test "Cosas mas peligrosas que nivel dado"{
        const bateria = new BateriaAntiaerea(tieneMisiles = true)
        const paqueteLadrillosDe10 = new PaqueteDeLadrillos(cantidad = 10)
        const residuos = new ResiduosRadiactivos(cantidad = 100)
        camion.cargar(bateria)
        camion.cargar(knightRider)
        assert.equals(#{bateria}, camion.cosasQueSuperanPeligrosidad(15))
        assert.equals(#{bateria}, camion.cosasMasPeligrosasQue(bumblebee))
        assert.equals(#{bateria, knightRider}, camion.cosasQueSuperanPeligrosidad(2))
        assert.equals(#{bateria, knightRider}, camion.cosasMasPeligrosasQue(paqueteLadrillosDe10))
        assert.equals(#{}, camion.cosasQueSuperanPeligrosidad(200))
        assert.equals(#{}, camion.cosasMasPeligrosasQue(residuos))
    }

}
describe "Circular en rutas"{
    test "Camion vacio puede circular en cualquier ruta"{
        assert.equals(true, camion.puedeCircularEnRutaDeNivel(0))
        assert.equals(true, camion.puedeCircularEnRutaDeNivel(10))
        assert.equals(true, camion.puedeCircularEnRutaDeNivel(1000))
    }
    test "Camion con solo un bumblebee modo auto puede circular en rutas de nivel 15 o mas"{
        camion.cargar(bumblebee)
        assert.equals(false, camion.puedeCircularEnRutaDeNivel(10))
        assert.equals(true, camion.puedeCircularEnRutaDeNivel(15))
        assert.equals(true, camion.puedeCircularEnRutaDeNivel(20))
    }
    test "Un camion con un bumblebee auto y un paquete de 300 ladrillos puede circular en una ruta de nivel 20"{
        const paquete300Ladrillos = new PaqueteDeLadrillos(cantidad = 300)
        camion.cargar(bumblebee)
        camion.cargar(paquete300Ladrillos)
        assert.equals(true, camion.puedeCircularEnRutaDeNivel(20))
    }
    test "Un camion con un bumblebee auto y un paquete de 400 ladrillos no puede circular en ruta nivel 20 por peso"{
        const paquete400Ladrillos = new PaqueteDeLadrillos(cantidad = 400)
        camion.cargar(bumblebee)
        camion.cargar(paquete400Ladrillos)
        assert.equals(true, camion.estaLleno())
        assert.equals(false, camion.puedeCircularEnRutaDeNivel(20))
    }
    test "Un camion con un bumblebee robot y un paquete de 300 ladrillos no puede circular en ruta de nivel 20 por peligrosdad"{
        const paquete300Ladrillos = new PaqueteDeLadrillos(cantidad = 300)
        camion.cargar(paquete300Ladrillos)
        bumblebee.cambiarModo()
        camion.cargar(bumblebee)
        assert.equals(false, camion.estaLleno())
        assert.equals(false, camion.puedeCircularEnRutaDeNivel(20))
    }

}
describe "Prueba de los nuevos objetos"{
    test "Un contenedor portuario vacio pesa 100kg y tiene peligrosidad 0"{
        assert.equals(100, contenedorPortuario.peso())
        assert.equals(0, contenedorPortuario.nivelPeligrosidad())
    }
    test "Un contenedor con un knight rider y 50kg de arena pesa 650kg y tiene peligrosidad 10"{
        const arena50kg = new ArenaAGranel(cantidad = 50)
        contenedorPortuario.cargar(knightRider)
        contenedorPortuario.cargar(arena50kg)
        assert.equals(650, contenedorPortuario.peso())
        assert.equals(10, contenedorPortuario.nivelPeligrosidad())
    }
    test "Si embalaje envuelve a knight rider pesa 500kg y tiene peligrosidad 5"{
        const embalaje = new EmbalajeDeSeguridad(cosaEmbalada = knightRider)
        assert.equals(500, embalaje.peso())
        assert.equals(5, embalaje.nivelPeligrosidad())
    }
    test "Si embalaje envuelve a Bumblebee modo auto pesa 800kg y tiene peligrosidad 7,5"{
        const embalaje = new EmbalajeDeSeguridad(cosaEmbalada = bumblebee)
        assert.equals(800, embalaje.peso())
        assert.equals(7.5, embalaje.nivelPeligrosidad())
    }
}
describe "Camion con nuevos mensajes de peso"{
    test "Saber si hay algo con peso entre 2 pesos dados"{
        const paquete300Ladrillos = new PaqueteDeLadrillos(cantidad = 300)
        camion.cargar(bumblebee)
        camion.cargar(paquete300Ladrillos)
        assert.equals(true, camion.tieneAlgoQuePesaEntre(5, 700))
        assert.equals(true, camion.tieneAlgoQuePesaEntre(5, 1000))
        assert.equals(false, camion.tieneAlgoQuePesaEntre(900, 1000))
    }
    test "Entre un bumblebee y un paquete de 300 ladrillos, la cosa mas pesada es bumblebee"{
        const paquete300Ladrillos = new PaqueteDeLadrillos(cantidad = 300)
        camion.cargar(bumblebee)
        camion.cargar(paquete300Ladrillos)
        assert.equals(bumblebee, camion.cosaMasPesada())
    }
    test "Si el camion esta vacio, tira una excepcion"{
        assert.throwsException({camion.cosaMasPesada()})
    }
    test "Peso de cada cosa cargada"{
        const paquete300Ladrillos = new PaqueteDeLadrillos(cantidad = 300)
        camion.cargar(bumblebee)
        camion.cargar(paquete300Ladrillos)
        assert.equals([800, 600], camion.pesoDeCadaCosaCargada())
    }
    
}